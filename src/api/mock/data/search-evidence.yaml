# =============================================================================
# Search Evidence & Reasoning Mock Data
# Structural Integrity Platform - GraphRAG Evidence Items
# =============================================================================

evidenceItems:
  - id: ev-001
    type: adr
    label: ADR-022
    title: "ADR-022: Data Classification Standard"
    description: Architecture Decision Record defining PII handling requirements
    content: |
      Title: Data Classification and Handling Standard
      Status: Active
      Date: 2024-03-15
      
      ## Context
      All user data must be classified and handled according to sensitivity levels.
      
      ## Decision
      PII fields (email, SSN, phone, address) require:
      1. Encryption at rest (AES-256)
      2. Encryption in transit (TLS 1.3)
      3. Access logging
      4. @Private decorator in code
      
      ## Consequences
      Non-compliance triggers GDPR Policy-082 enforcement.
    source: docs/architecture/adr-022.md
    confidence: 0.98

  - id: ev-002
    type: source
    label: "src/auth/tracker.ts:142"
    title: UserTracking Module - Line 142
    description: Code location where unclassified PII handling was detected
    content: |
      138: export class UserTracker {
      139:   constructor(private analytics: AnalyticsV2) {}
      140: 
      141:   track(user: User) {
      142:     this.analytics.record(user.email, user.behavior);
      143:     // ^^^^^ Missing @Private decorator
      144:   }
      145: }
    language: typescript
    source: src/auth/tracker.ts
    line: 142
    confidence: 1.0

  - id: ev-003
    type: policy
    label: Policy-082
    title: "Policy-082: GDPR Data Protection"
    description: Active governance policy enforcing PII protection
    content: |
      package substrate.gdpr
      
      import future.keywords.if
      import future.keywords.in
      
      pii_fields := {"email", "ssn", "phone", "address"}
      
      deny contains msg if {
          some field in input.schema.fields
          field.name in pii_fields
          not field.has_decorator("@Private")
          msg := sprintf("PII field %s lacks @Private decorator", [field.name])
      }
    language: rego
    source: policies/gdpr/pii-protection.rego
    confidence: 0.95

  - id: ev-004
    type: graph
    label: Leiden Community
    title: Community Detection Analysis
    description: Graph clustering showing module relationships
    content: |
      Community ID: C-42
      Nodes: 15
      Edges: 23
      Density: 0.34
      
      Detected Modules:
      - Checkout Service (hub)
      - Payment Gateway
      - User Tracking
      - Analytics V2
      - Data Pipeline
      
      Anomaly: UserTracking → AnalyticsV2 edge lacks 
      PII classification metadata (expected: HIGH, found: UNCLASSIFIED)
    source: graph-analysis/community-42.json
    confidence: 0.87

  - id: ev-005
    type: pr
    label: "PR #421"
    title: "Pull Request #421: Analytics Integration"
    description: Recent change introducing the violation
    content: |
      Author: @developer-jane
      Date: 2024-09-01
      Status: Merged
      
      Changes:
      + Added AnalyticsV2 integration
      + User behavior tracking
      - Missing: @Private decorators
      - Missing: PII classification tags
      
      Review Comments:
      > Security: Please add @Private to user.email access
      > (No response)
    source: https://github.com/org/repo/pull/421
    confidence: 0.92

  - id: ev-006
    type: jira
    label: TASK-882
    title: "TASK-882: Authentication Flow"
    description: Jira ticket describing intended implementation
    content: |
      Summary: Implement user authentication flow
      Type: Task
      Priority: High
      
      Description:
      Implement OAuth 2.0 authentication flow for web application.
      
      Acceptance Criteria:
      - [ ] OAuth login with Google
      - [ ] OAuth login with GitHub
      - [ ] Session management
      
      Note: SAML integration will be handled separately in TASK-900
    source: https://jira.company.com/browse/TASK-882
    confidence: 0.89

reasoningResults:
  - id: res-001
    query: "Which services handle PII but are not mentioned in our GDPR compliance doc?"
    summary: Structural inconsistency detected in UserTracking module
    analysis: |
      Analyzing Checkout Service and Data Pipeline...
      
      Based on the Leiden Community Detection of your monorepo, I found a structural inconsistency.
      
      The UserTracking module imports AnalyticsV2, which lacks the @Private decorator required by Policy-082 for PII handling.
      
      Evidence chain:
      1. ADR-022 defines PII handling requirements
      2. Source code shows user.email access without @Private
      3. Policy-082 explicitly requires @Private decorator
      4. Graph analysis reveals community with high PII handling
      5. PR #421 introduced the violation
    services:
      - Checkout Service
      - Data Pipeline
      - UserTracking
      - AnalyticsV2
    severity: high
    evidenceIds:
      - ev-001
      - ev-002
      - ev-003
      - ev-004
      - ev-005

  - id: res-002
    query: "Find circular dependencies in the payment module"
    summary: 2 circular dependency chains detected
    analysis: |
      Analyzing Payment Gateway dependencies...
      
      Found 2 circular dependency chains violating ADR-004:
      
      1. PaymentService → OrderService → PaymentService
         - File: src/payments/service.ts:45
         - Imports OrderService for validation
         
      2. InvoiceGenerator → TaxCalculator → InvoiceGenerator
         - File: src/billing/invoice.ts:78
         - Tax calculation requires invoice context
      
      These patterns increase coupling and complicate testing.
      Recommendation: Extract shared interfaces to break cycles.
    services:
      - PaymentService
      - OrderService
      - InvoiceGenerator
      - TaxCalculator
    severity: medium
    evidenceIds:
      - ev-adr-004
      - ev-dep-graph
      - ev-pr-389

  - id: res-003
    query: "What components are at risk due to the Checkout_API ownership gap?"
    summary: 5 components affected by ownership gap
    analysis: |
      Analyzing downstream dependencies of Checkout_API...
      
      The ownership gap in Checkout_API creates risk for:
      
      1. Payment Gateway (direct dependency)
         - Payment processing may stall on critical issues
         
      2. Order Service (indirect via events)
         - Order state transitions depend on checkout completion
         
      3. Inventory Service (event consumer)
         - Stock reservation logic tied to checkout flow
         
      4. Notification Service
         - Order confirmation emails triggered by checkout
         
      5. Analytics Pipeline
         - Revenue tracking depends on checkout events
      
      3 critical bugs pending with no owner to triage.
    services:
      - Checkout_API
      - Payment Gateway
      - Order Service
      - Inventory Service
      - Notification Service
      - Analytics Pipeline
    severity: high
    evidenceIds:
      - ev-owner-gap
      - ev-dep-graph
      - ev-bugs-001

evidenceTypes:
  adr:
    label: ADR
    color: blue
    icon: FileText
  source:
    label: Source Code
    color: amber
    icon: Code
  policy:
    label: Policy
    color: purple
    icon: ShieldCheck
  graph:
    label: Graph Analysis
    color: emerald
    icon: GitBranch
  pr:
    label: Pull Request
    color: slate
    icon: GitPullRequest
  jira:
    label: Jira Ticket
    color: blue
    icon: Ticket
