# =============================================================================
# Graph Edges Mock Data
# Structural Integrity Platform - Knowledge Graph Relationships
# =============================================================================

edges:
  # ============================================================================
  # Reality Layer - Actual Implementation Dependencies
  # ============================================================================
  
  # Core API connections
  - id: edge_core_auth
    from: core_api
    to: auth_svc
    type: calls
    color: "#3b82f6"
    width: 2
    lens: [reality, intent, drift]
    metadata:
      protocol: HTTPS
      auth: JWT
      rateLimit: 1000

  - id: edge_core_db_orders
    from: core_api
    to: db_orders
    type: writes_to
    color: "#3b82f6"
    width: 2
    lens: [reality, drift]
    metadata:
      connectionPool: 20
      queryType: CRUD

  - id: edge_core_payment
    from: core_api
    to: payment_gw
    type: calls
    color: "#3b82f6"
    width: 2
    lens: [reality, intent]
    metadata:
      timeout: 5000
      retryPolicy: exponential

  - id: edge_core_notify
    from: core_api
    to: notification_svc
    type: calls
    color: "#3b82f6"
    width: 2
    lens: [reality, intent]
    metadata:
      async: true
      queue: event_queue

  - id: edge_core_inventory
    from: core_api
    to: inventory_svc
    type: calls
    color: "#3b82f6"
    width: 2
    lens: [reality, intent, drift]
    metadata:
      caching: true
      cacheTtl: 300

  # Auth Service connections
  - id: edge_auth_db_users
    from: auth_svc
    to: db_users
    type: reads_from
    color: "#3b82f6"
    width: 2
    lens: [reality, drift]
    metadata:
      encryption: AES-256
      piiAccess: true

  # Payment Gateway connections
  - id: edge_payment_stripe
    from: payment_gw
    to: stripe_api
    type: calls
    color: "#10b981"
    width: 2
    lens: [reality, intent]
    metadata:
      external: true
      webhookEnabled: true

  - id: edge_payment_cache
    from: payment_gw
    to: redis_cache
    type: writes_to
    color: "#3b82f6"
    width: 2
    lens: [reality]
    metadata:
      cacheKeyPattern: payment:*

  # Notification Service connections
  - id: edge_notify_sendgrid
    from: notification_svc
    to: sendgrid_api
    type: calls
    color: "#10b981"
    width: 2
    lens: [reality, intent]
    metadata:
      external: true
      batchSize: 100

  - id: edge_notify_queue
    from: notification_svc
    to: event_queue
    type: reads_from
    color: "#3b82f6"
    width: 2
    lens: [reality, intent]
    metadata:
      consumerGroup: notification-workers

  # Inventory connections
  - id: edge_inventory_db
    from: inventory_svc
    to: db_orders
    type: reads_from
    color: "#3b82f6"
    width: 2
    lens: [reality]
    metadata:
      readReplica: true

  - id: edge_inventory_shipping
    from: inventory_svc
    to: shipping_svc
    type: calls
    color: "#3b82f6"
    width: 2
    lens: [reality, intent]
    metadata:
      sync: false

  # Shipping connections
  - id: edge_shipping_db
    from: shipping_svc
    to: db_orders
    type: writes_to
    color: "#3b82f6"
    width: 2
    lens: [reality]
    metadata:
      transaction: true

  # Event Queue connections
  - id: edge_core_queue
    from: core_api
    to: event_queue
    type: writes_to
    color: "#3b82f6"
    width: 2
    lens: [reality, intent]
    metadata:
      eventTypes: [order.created, payment.processed, user.registered]

  # ============================================================================
  # Intent Layer - Architectural Requirements
  # ============================================================================

  # Policy connections (dashed lines indicate policy enforcement points)
  - id: edge_core_policy_api
    from: core_api
    to: policy_api
    type: implements
    color: "#a855f7"
    width: 2
    dashed: "6,3"
    lens: [intent, drift]
    metadata:
      policyType: enforcement
      compliance: required

  - id: edge_auth_policy_gdpr
    from: auth_svc
    to: policy_gdpr
    type: implements
    color: "#a855f7"
    width: 2
    dashed: "6,3"
    lens: [intent, drift]
    metadata:
      policyType: compliance
      gdprArticle: 32

  - id: edge_payment_policy_gdpr
    from: payment_gw
    to: policy_gdpr
    type: implements
    color: "#a855f7"
    width: 2
    dashed: "6,3"
    lens: [intent]
    metadata:
      policyType: compliance
      gdprArticle: 32

  - id: edge_tracker_policy_gdpr
    from: shadow_tracker
    to: policy_gdpr
    type: implements
    color: "#a855f7"
    width: 2
    dashed: "6,3"
    lens: [intent]
    metadata:
      policyType: compliance
      gdprArticle: 25

  # ============================================================================
  # Drift Layer - Violations and Issues
  # ============================================================================

  # DRIFT VIOLATION: Undocumented database access
  - id: edge_drift_db_tracker
    from: db_orders
    to: shadow_tracker
    type: reads_from
    color: "#ef4444"
    width: 3
    dashed: "10,5"
    animate: true
    isViolation: true
    lens: [drift]
    opacityInDrift: 1.0
    metadata:
      violationType: undocumented_dependency
      severity: High
      policy: ADR-022
      description: Shadow Tracker reads from DB_ORDERS without documented authorization
      detectedAt: "2024-09-15T10:30:00Z"
      suggestedActions:
        - update_intent
        - refactor_reality
        - false_positive

  # DRIFT: Shadow tracker connection to core (unintended coupling)
  - id: edge_core_tracker
    from: core_api
    to: shadow_tracker
    color: "#1e293b"
    width: 2
    always: true
    lens: [reality, drift]
    metadata:
      dependencyType: direct_import
      notes: Direct import detected in src/api/handlers.ts

  # DRIFT: Inventory service bypassing API gateway (architectural smell)
  - id: edge_inventory_notify
    from: inventory_svc
    to: notification_svc
    type: calls
    color: "#f59e0b"
    width: 2
    dashed: "4,4"
    lens: [drift]
    opacityInDrift: 0.7
    metadata:
      violationType: layer_violation
      severity: Medium
      description: Inventory service directly calls Notification service, bypassing event queue
      detectedAt: "2024-09-10T14:22:00Z"

  # DRIFT: Deprecated shipping API usage
  - id: edge_shipping_deprecated
    from: shipping_svc
    to: stripe_api
    type: calls
    color: "#f59e0b"
    width: 1
    dashed: "4,4"
    lens: [drift]
    opacityInDrift: 0.5
    metadata:
      violationType: deprecated_api
      severity: Low
      description: Using deprecated Stripe API v2023-08
      detectedAt: "2024-09-08T09:15:00Z"

  # ============================================================================
  # Invisible / Always present structural edges
  # ============================================================================
  
  - id: edge_structural_1
    from: core_api
    to: shadow_tracker
    color: "#1e293b"
    width: 1
    always: true
    lens: []
    metadata:
      type: structural

  - id: edge_structural_2
    from: payment_gw
    to: db_orders
    color: "#1e293b"
    width: 1
    always: true
    lens: []
    metadata:
      type: structural
